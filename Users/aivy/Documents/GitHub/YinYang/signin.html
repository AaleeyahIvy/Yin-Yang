<!DOCTYPE html>
<html>
<head>
  <link rel="icon" type="image/x-icon" href="images/favicon.ico">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <link rel="stylesheet" href="main2.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Thasadith&display=swap" rel="stylesheet">
    <title>Yin Yang App</title>
</head>
    <body onload="myFunction()" style="margin:0;">
        <nav class="col-12 nav">
            <a href="about.html">About</a>
            <a href="contact.html">Contact</a>
            <a href="signin.html">Sign In</a>
          </nav>
    <div id="loader">
        <svg class="background-layer" viewBox='-14 -7 28 14' xmlns='http://www.w3.org/2000/svg'>
            <circle r='6' />
            <path d='M0 6
            A6 6 0 0 1 0-6
            A3 3 0 0 1 0 0
            A3 3 0 0 0 0 6
            M0 2
            A1 1 0 0 1 0 4
            A1 1 0 0 1 0 2' fill='#fff' />
            <circle r='1' cy='-3' />
        </svg>
    </div>
    <div style="display:none;" id="myDiv" class="col-12 animate-bottom">
        <h1>Sign In</h1>
        <h2>Welcome Back:</h2>
        <form style="font-weight: bold;" action="app.html" method="GET">
          <label for="email">Email:</label>
          <input type="text" id="email" name="email" placeholder="Enter Email" required><br>
          <label for="password">Password:</label>
          <input type="psw" id="password" name="password" placeholder="Enter Password" required><br>
          <br>
          <label for="submit">Get Started!!!!</label>
          <input class="submit" name="submit" type="submit" value="Submit">
        </form>
    </div>
    <div class="quickstart-user-details-container">
        Firebase sign-in status: <span id="quickstart-sign-in-status">Unknown</span>
        <div>Firebase auth <code>currentUser</code> object value:</div>
        <pre><code id="quickstart-account-details">null</code></pre>
        <script>
            var myVar;
        function myFunction() {
          myVar = setTimeout(showPage, 5000);
        }
        function showPage() {
          document.getElementById("loader").style.display = "none";
          document.getElementById("myDiv").style.display = "inline-block";
        }
            var path = anime.path('.background-layer');
            anime.timeline({ loop: false })
                .add({
                    targets: '.background-layer',
                    rotate: 560,
                    duration: 5000,
                    loop: 1
                });
        </script>
        <script src="/__/firebase/init.js"></script>
        <script type="module">
        import { getAuth, onAuthStateChanged } from "/firebase/auth";
        var firebase = require('firebase');
        var firebaseui = require('firebaseui');
        var ui = new firebaseui.auth.AuthUI(firebase.auth());
        const auth = getAuth(firebaseApp);
        /**
         * Handles the sign in button press.
         */
        function toggleSignIn() {
          if (firebase.auth().currentUser) {
            firebase.auth().signOut();
          } else {
            var email = document.getElementById('email').value;
            var password = document.getElementById('password').value;
            if (email.length < 4) {
              alert('Please enter an email address.');
              return;
            }
            if (password.length < 4) {
              alert('Please enter a password.');
              return;
            }
            // Sign in with email and pass.
            firebase.auth().signInWithEmailAndPassword(email, password).catch(function(error) {
              // Handle Errors here.
              var errorCode = error.code;
              var errorMessage = error.message;
              if (errorCode === 'auth/wrong-password') {
                alert('Wrong password.');
              } else {
                alert(errorMessage);
              }
              console.log(error);
              document.getElementById('quickstart-sign-in').disabled = false;
            });
          }
          document.getElementById('quickstart-sign-in').disabled = true;
        }
    
        /**
         * Handles the sign up button press.
         */
        function handleSignUp() {
          var email = document.getElementById('email').value;
          var password = document.getElementById('password').value;
          if (email.length < 4) {
            alert('Please enter an email address.');
            return;
          }
          if (password.length < 4) {
            alert('Please enter a password.');
            return;
          }
          // Create user with email and pass.
          firebase.auth().createUserWithEmailAndPassword(email, password).catch(function(error) {
            // Handle Errors here.
            var errorCode = error.code;
            var errorMessage = error.message;
            if (errorCode == 'auth/weak-password') {
              alert('The password is too weak.');
            } else {
              alert(errorMessage);
            }
            console.log(error);
          });
        }
    
        /**
         * Sends an email verification to the user.
         */
        function sendEmailVerification() {
          firebase.auth().currentUser.sendEmailVerification().then(function() {
            // Email Verification sent!
            alert('Email Verification Sent!');
          });
        }
    
        function sendPasswordReset() {
          var email = document.getElementById('email').value;
          firebase.auth().sendPasswordResetEmail(email).then(function() {
            // Password Reset Email Sent!
            alert('Password Reset Email Sent!');
          }).catch(function(error) {
            // Handle Errors here.
            var errorCode = error.code;
            var errorMessage = error.message;
            if (errorCode == 'auth/invalid-email') {
              alert(errorMessage);
            } else if (errorCode == 'auth/user-not-found') {
              alert(errorMessage);
            }
            console.log(error);
          });
        }
    
        /**
         * initApp handles setting up UI event listeners and registering Firebase auth listeners:
         *  - firebase.auth().onAuthStateChanged: This listener is called when the user is signed in or
         *    out, and that is where we update the UI.
         */
        function initApp() {
          // Listening for auth state changes.
          firebase.auth().onAuthStateChanged(function(user) {
            document.getElementById('quickstart-verify-email').disabled = true;
            if (user) {
              // User is signed in.
              var displayName = user.displayName;
              var email = user.email;
              var uid = user.uid;
              var providerData = user.providerData;
              document.getElementById('quickstart-sign-in-status').textContent = 'Signed in';
              document.getElementById('quickstart-sign-in').textContent = 'Sign out';
              document.getElementById('quickstart-account-details').textContent = JSON.stringify(user, null, '  ');
              if (!emailVerified) {
                document.getElementById('quickstart-verify-email').disabled = false;
              }
            } else {
              // User is signed out.
              document.getElementById('quickstart-sign-in-status').textContent = 'Signed out';
              document.getElementById('quickstart-sign-in').textContent = 'Sign in';
              document.getElementById('quickstart-account-details').textContent = 'null';
            }
            document.getElementById('quickstart-sign-in').disabled = false;
          });
    
          document.getElementById('sign-in').addEventListener('click', toggleSignIn, false);
          document.getElementById('sign-up').addEventListener('click', handleSignUp, false);
          document.getElementById('verify-email').addEventListener('click', sendEmailVerification, false);
          document.getElementById('password-reset').addEventListener('click', sendPasswordReset, false);
        }
    
        window.onload = function() {
          initApp();
        }; 
        </script>
    
    <script type="module" src="/__/firebase/init.js">
    import { getDatabase, ref, set } from "firebase/database";
    function writeUserData(password, email) {
    const db = getDatabase();
    set(ref(db, 'users/' + userId), {
    username: fullname,
    email: email
  });
}
document.getElementById('submit').addEventListener('click', writeUserData);
    </script>
    <footer>
        Created By: Aaleeyah Ivy & Austin Kilgore using Anime.Js, HTML, JS, CSS, and etc.
    </footer>
</body>
</html>
